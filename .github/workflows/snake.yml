name: ğŸ Ultimate Snake Generator â€” Aditya Singh Edition

on:
  schedule:
    - cron: "0 3 * * *"  # Runs every day at 3 AM IST
  workflow_dispatch:      # Manual trigger from Actions tab
  push:
    branches:
      - main

jobs:
  build-snake:
    runs-on: ubuntu-latest

    permissions:
      contents: write     # âœ… Required to push to output branch
      actions: read

    env:
      USERNAME: adityasinnghh
      OUTPUT_DIR: dist
      LIGHT_THEME: github-light
      DARK_THEME: github-dark

    steps:
      - name: ğŸ§© Checkout repository
        uses: actions/checkout@v4

      - name: âš¡ Setup cache for faster builds
        uses: actions/cache@v3
        with:
          path: ~/.cache/snk
          key: ${{ runner.os }}-snk

      - name: ğŸ Generate animated contribution snakes (SVG + GIF)
        uses: Platane/snk@v3
        with:
          github_user_name: ${{ env.USERNAME }}
          outputs: |
            ${{ env.OUTPUT_DIR }}/github-contribution-grid-snake.svg
            ${{ env.OUTPUT_DIR }}/github-contribution-grid-snake-dark.svg?palette=${{ env.DARK_THEME }}
            ${{ env.OUTPUT_DIR }}/github-contribution-grid-snake-light.svg?palette=${{ env.LIGHT_THEME }}
            ${{ env.OUTPUT_DIR }}/github-contribution-grid-snake.gif

      - name: âœ¨ Generate a random commit message
        id: commitmsg
        run: |
          msgs=("âœ¨ Updated snake animation" "ğŸ New snake slithering" "ğŸš€ Snake regenerated" "ğŸ§  Fresh commits detected" "ğŸ”¥ Animated grid refreshed")
          echo "message=${msgs[$RANDOM % ${#msgs[@]}]}" >> $GITHUB_OUTPUT

      - name: ğŸš€ Push snakes to output branch
        uses: crazy-max/ghaction-github-pages@v3.1.0
        with:
          target_branch: output
          build_dir: ${{ env.OUTPUT_DIR }}
          commit_message: ${{ steps.commitmsg.outputs.message }}
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      - name: ğŸ‰ Success Log
        run: |
          echo "âœ… Snake animation generated successfully!"
          echo "ğŸŒ View it here:"
          echo "â¡ï¸  https://raw.githubusercontent.com/${{ env.USERNAME }}/${{ env.USERNAME }}/output/github-contribution-grid-snake.svg"
