name: ğŸ Snake Generator â€” Aditya Singh Edition v2 (Rainbow Mode)

on:
  schedule:
    - cron: "0 3 * * *"  # ğŸ•’ Runs daily at 3 AM IST
  workflow_dispatch:      # ğŸ® Manual trigger
  push:
    branches:
      - main

jobs:
  build-snake:
    runs-on: ubuntu-latest

    permissions:
      contents: write
      actions: read

    env:
      USERNAME: adityasinnghh
      OUTPUT_DIR: dist

      THEME_DARK: github-dark
      THEME_LIGHT: github-light
      THEME_RAINBOW: github-dark-dimmed,github-light,github-dark,github

    steps:
      - name: ğŸ§© Checkout repository
        uses: actions/checkout@v4

      - name: âš¡ Cache build data
        uses: actions/cache@v3
        with:
          path: ~/.cache/snk
          key: ${{ runner.os }}-snk-cache

      - name: ğŸ Generate Snake SVGs (Dark + Light)
        uses: Platane/snk@v3
        with:
          github_user_name: ${{ env.USERNAME }}
          outputs: |
            ${{ env.OUTPUT_DIR }}/snake-dark.svg?palette=${{ env.THEME_DARK }}
            ${{ env.OUTPUT_DIR }}/snake-light.svg?palette=${{ env.THEME_LIGHT }}

      - name: ğŸŒˆ Generate Rainbow Gradient Snake
        run: |
          mkdir -p ${{ env.OUTPUT_DIR }}
          curl -s "https://raw.githubusercontent.com/Platane/snk/output/github-contribution-grid-snake.svg" -o "${{ env.OUTPUT_DIR }}/snake-rainbow.svg"
          sed -i 's/#39d353/#ff00ff/g; s/#26a641/#ff9900/g; s/#006d32/#00ffff/g' "${{ env.OUTPUT_DIR }}/snake-rainbow.svg"
          echo "ğŸ¨ Rainbow gradient snake generated."

      - name: ğŸï¸ Generate Animated GIF Snake
        uses: Platane/snk@v3
        with:
          github_user_name: ${{ env.USERNAME }}
          outputs: |
            ${{ env.OUTPUT_DIR }}/snake.gif

      - name: âœ¨ Generate random emoji commit message
        id: commitmsg
        run: |
          msgs=("ğŸ Slithering rainbow snake" "ğŸŒˆ Vibrant snake regenerated" "ğŸ”¥ Neon trails activated" "ğŸ§  Matrix-style grid refresh" "âš¡ Shiny new commit paths")
          echo "message=${msgs[$RANDOM % ${#msgs[@]}]}" >> $GITHUB_OUTPUT

      - name: ğŸš€ Deploy Snakes to output branch
        uses: crazy-max/ghaction-github-pages@v3.1.0
        with:
          target_branch: output
          build_dir: ${{ env.OUTPUT_DIR }}
          commit_message: ${{ steps.commitmsg.outputs.message }}
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}

      - name: ğŸ‰ Final Log Output
        run: |
          echo "=============================="
          echo "ğŸ Snake Animation Generated!"
          echo "ğŸ‘¤ User: ${{ env.USERNAME }}"
          echo "ğŸŒˆ Versions: Dark, Light, Rainbow, GIF"
          echo "ğŸš€ Pushed to: output branch"
          echo "ğŸ¨ Live preview:"
          echo "  ğŸ”— https://raw.githubusercontent.com/${{ env.USERNAME }}/${{ env.USERNAME }}/output/snake-rainbow.svg"
          echo "=============================="
